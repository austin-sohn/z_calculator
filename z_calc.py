# z score calculator using tkinter gui
# 3/15/21
# z = (x - mean) / sd

import tkinter
from tkinter import messagebox
import decimal

# initial
window = tkinter.Tk()
window.title("Z-Score Calculator")
window.geometry("300x200")

# z score function
def z_score():
    # Z table
    neg_z = [[.0003, .0003, .0003, .0003, .0003, .0003, .0003, .0003, .0003, .0002], # -3.4
            [.0005, .0005, .0005, .0004, .0004, .0004, .0004, .0004, .0004, .0003], # -3.3
            [.0007, .0007, .0006, .0006, .0006, .0006, .0006, .0005, .0005, .0005], # -3.2
            [.001, .0009, .0009, .0009, .0008, .0008, .0008, .0008, .0007, .0007], # -3.1
            [.0013, .0013, .0013, .0012, .0012, .0011, .0011, .0011, .001, .001], # -3.0
            [.0019, .0018, .0018, .0017, .0016, .0016, .0015, .0015, .0014, .0014], # -2.9
            [.0026, .0025, .0024, .0023, .002, .0022, .0021, .0021, .002, .0019], # -2.8
            [.0035, .0034, .0033, .0032, .0031, .003, .0029, .0028, .0027, .0026], # -2.7
            [.0047, .0045, .0044, .0043, .0041, .004, .0039, .0038, .0037, .0036], # -2.6
            [.0062, .006, .0059, .0057, .0055, .0054, .0052, .0051, .0049, .0048], # -2.5
            [.0082, .008, .0078, .0075, .0073, .0071, .0069, .0068, .0066, .0064], # -2.4
            [.0107, .0104, .0102, .0099, .0096, .0094, .0091, .0089, .0087, .0084], # -2.3
            [.0139, .0136, .0132, .0129, .0125, .0122, .0119, .0116, .0113, .011], # -2.2
            [.0179, .0174, .017, .0166, .0162, .0158, .0154, .015, .0146, .0143], # -2.1
            [.0228, .0222, .0217, .0212, .0207, .0202, .0197, .0192, .0188, .0183], # -2.0
            [.0287, .0281, .0274, .0268, .0262, .0256, .025, .0244, .0239, .0233], # -1.9
            [.0359, .0351, .0344, .0336, .0329, .0322, .0314, .0307, .0301, .0294], # -1.8
            [.0446, .0436, .0427, .0418, .0409, .0401, .0392, .0384, .0375, .0367], # -1.7
            [.0548, .0537, .0526, .0516, .0505, .0495, .0485, .0475, .0465, .0455], # -1.6
            [.0668, .0655, .0643, .0630, .0618, .0606, .0594, .0582, .0571, .0559], # -1.5
            [.0808, .0793, .0778, .0764, .0749, .0735, .0721, .0708, .0694, .0681], # -1.4
            [.0968, .0951, .0934, .0918, .0901, .0885, .0869, .0853, .0838, .0823], # -1.3
            [.1151, .1131, .1112, .1093, .1075, .1056, .1038, .102, .1003, .0985], # -1.2
            [.1357, .1335, .1314, .1292, .1271, .1251, .123, .121, .119, .117], # -1.1
            [.1587, .1562, .1539, .1515, .1492, .1469, .1446, .1423, .1401, .1379], # -1.0
            [.1841, .1814, .1788, .1762, .1736, .1711, .1685, .166, .1635, .1611], # -0.9
            [.2119, .209, .2061, .2033, .2005, .1977, .1949, .1922, .1894, .1867], # -0.8
            [.2420, .2389, .2358, .2327, .2296, .2266, .2236, .2206, .2177, .2148], # -0.7
            [.2743, .2709, .2676, .2643, .2611, .2578, .2546, .2514, .2483, .2451], # -0.6
            [.3085, .305, .3015, .2981, .2946, .2912, .2877, .2843, .281, .2776], # -0.5
            [.3446, .3409, .3372, .3336, .33, .3264, .3228, .3192, .3156, .3121], # -0.4
            [.3821, .3783, .3745, .3707, .3669, .3632, .3594, .3557, .352, .3483], # -0.3
            [.4207, .4168, .4129, .409, .4052, .4013, .3974, .3936, .3897, .3859], # -0.2
            [.4602, .4562, .4522, .4483, .4443, .4404, .4364, .4325, .4286, .4247], # -0.1
            [.5, .496, .492, .488, .484, .4801, .4761, .4721, .4681, .4641]] # -0.0

    pos_z = [[.5, .504, .508, .512, .516, .5199, .5239, .5279, .5319, .5359], # 0.0
            [.5398, .5438, .5478, .5517, .5557, .5596, .5636, .5675, .5714, .5753], # 0.1
            [.5793, .5832, .5871, .591, .5948, .5987, .6026, .6064, .6103, .6141], # 0.2
            [.6179, .6217, .6255, .6293, .6331, .6368, .6406, .6443, .648, .6517], # 0.3
            [.6554, .6591, .6628, .6664, .67, .6736, .6772, .6808, .6844, .6879], # 0.4
            [.6915, .695, .6985, .7019, .7054, .7088, .7123, .7157, .719, .7224], # 0.5
            [.7257, .7611, .7642, .7673, .7704, .7734, .7764, .7794, .7823, .7852], # 0.6
            [.758, .7611, .7642, .7673, .7704, .7734, .7764, .7794, .7823, .7852], # 0.7
            [.7881, .791, .7939, .7967, .7995, .8023, .8051, .8078, .8106, .8133], # 0.8
            [.8159, .8186, .8212, .8238, .8264, .8289, .8315, .834, .8365, .8389], # 0.9
            [.8413, .8438, .8461, .8485, .8508, .8531, .8554, .8577, .8599, .8621], # 1.0
            [.8643, .8665, .8686, .8708, .8729, .8749, .877, .879, .881, .883], # 1.1
            [.8849, .8869, .8888, .8907, .8925, .8944, .8962, .898, .8997, .9015], # 1.2
            [.9032, .9049, .9066, .9082, .9099, .9115, .9131, .9147, .9162, .9177], # 1.3
            [.9192, .9207, .9222, .9236, .925, .9265, .9279, .9292, .9306, .9319], # 1.4
            [.9332, .9345, .9357, .937, .9382, .9394, .9406, .9418, .9429, .9441], # 1.5
            [.9452, .9463, .9474, .9484, .9495, .9505, .9515, .9525, .9535, .9545], # 1.6
            [.9554, .9564, .9573, .9582, .9591, .9599, .9608, .9616, .9625, .9633], # 1.7
            [.9641, .9649, .9656, .9664, .9671, .9678, .9686, .9693, .9699, .9706], # 1.8
            [.9713, .9719, .9726, .9732, .9738, .9744, .975, .9756, .9761, .9767], # 1.9
            [.9772, .9778, .9783, .9788, .9793, .9798, .9803, .9808, .9812, .9817], # 2.0
            [.9821, .9826, .983, .9834, .9838, .9842, .9846, .985, .9854, .9857], # 2.1
            [.9861, .9864, .9868, .9871, .9875, .9878, .9881, .9884, .9887, .989], # 2.2
            [.9893, .9896, .9898, .9901, .9904, .9906, .9909, .9911, .9913, .9916], # 2.3
            [.9918, .992, .9922, .9925, .9927, .9929, .9931, .9932, .9934, .9936], # 2.4
            [.9938, .994, .9941, .9943, .9945, .9946, .9948, .9949, .9951, .9952], # 2.5
            [.9953, .9955, .9956, .9957, .9959, .996, .9961, .9962, .9963, .9964], # 2.6
            [.9965, .9966, .9967, .9968, .9969, .997, .9971, .9972, .9973, .9974], # 2.7
            [.9974, .9975, .9976, .9977, .9977, .9978, .9979, .9979, .998, .9981], # 2.8
            [.9981, .9982, .9982, .9983, .9984, .9984, .9985, .9985, .9986, .9986], # 2.9
            [.9987, .9987, .9987, .9988, .9988, .9989, .9989, .9989, .999, .999], # 3.0
            [.999, .9991, .9991, .9991, .9992, .9992, .9992, .9992, .9993, .9993], # 3.1
            [.9993, .9993, .9994, .9994, .9994, .9994, .9994, .9995, .9995, .9995], # 3.2
            [.9995, .9995, .9995, .9996, .9996, .9996, .9996, .9996, .9996, .9997], # 3.3
            [.9997, .9997, .9997, .9997, .9997, .9997, .9997, .9997, .9997, .9998],] # 3.4
 
    mean = float(e1.get())
    sd = float(e2.get())
    user = float(e3.get())
    if sd != 0:
        total = user - mean
        total = str(round(total / sd, 2))
        if float(total) >= -3.4 and float(total) <= 3.4:
            first = int((float(total[0:total.find('.') + 2]) * 10)) # get first 2 # and * by 10 to make whole #
            hundredth = 0
            d = decimal.Decimal(total) # check how many decimals
            if d.as_tuple().exponent == -2:
                hundredth = int(total[-1]) # get last number (hundredth number)        
            if first < 0:
                z_score = neg_z[first + 34][hundredth]
            else:
                z_score = pos_z[first][hundredth]
            total_lbl = tkinter.Label(window, text = "Z is: " + str(total))
            z_lbl = tkinter.Label(window, text = 'Z-score is: ' + str(z_score))
            total_lbl.grid(row = 4, column = 0, sticky = 'w')
            z_lbl.grid(row = 5, column = 0, sticky = 'w')
        else:
            messagebox.showwarning(title = "ERROR", message = 'Z-score is out of range')
    else:
        messagebox.showwarning(title = "ERROR", message = 'Standard Deviation cannot be 0')

# labels
mean_lbl = tkinter.Label(window, text = "Mean: ")
sd_lbl = tkinter.Label(window, text = "Standard Deviation: ")
user_lbl = tkinter.Label(window, text = "Amount (x): ")

# entries
e1 = tkinter.Entry(window)
e2 = tkinter.Entry(window)
e3 = tkinter.Entry(window)

# buttons
submit = tkinter.Button(window, text = "Find Z, and Z-Score", command = z_score)

# placement
mean_lbl.grid(row = 0, column = 0, sticky = 'w')
sd_lbl.grid(row = 1, column = 0, sticky = 'w')
user_lbl.grid(row = 2, column = 0, sticky = 'w')
e1.grid(row = 0, column = 1)
e2.grid(row = 1, column = 1)
e3.grid(row = 2, column = 1)
submit.grid(row = 3)

window.mainloop()
